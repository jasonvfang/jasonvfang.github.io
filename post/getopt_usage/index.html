<!DOCTYPE html>
<html lang="en-US">
<head>
    <meta charset="utf-8">
    
    <title>Linux å‘½ä»¤è¡Œå‚æ•°å¤„ç† | Indigo Theme</title>
    <meta name="description" content="Description of website for head meta tag">
    <meta name="author" content="">
    
    <link rel="apple-touch-icon" sizes="180x180" href=https://example.com/apple-touch-icon.png>
    <link rel="icon" type="image/png" sizes="32x32" href=https://example.com/favicon-32x32.png>
    <link rel="icon" type="image/png" sizes="16x16" href=https://example.com/favicon-16x16.png>
    <link rel="manifest" href=https://example.com/site.webmanifest>
    <link rel="mask-icon" href=https://example.com/safari-pinned-tab.svg color="#00416a">
    <meta name="msapplication-TileColor" content="#00aba9">
    <meta name="theme-color" content="#ffffff">
    
    <link rel="me" href="mailto:email.address@example.com">
    <link rel="me" href="https://github.com/GitHubUserName">
    <link rel="me" href="https://twitter.com/TwitterUserName">
    <link rel="me" href="https://micro.blog/MicroBlogUserName">
    
    <link rel="authorization_endpoint" href=https://indieauth.com/auth />
    <link rel="token_endpoint" href=https://tokens.indieauth.com/token />
    
    
    
    
    
    <link rel="stylesheet" href=https://example.com/css/fonts.css />
    <link rel="stylesheet" href=https://example.com/css/style.css />
    
    <meta name="viewport" content="width=device-width, initial-scale=1">
</head>

<body>
    <div id="sitelogo">
        <a class="glyph" alt="Home" href="https://example.com/"><img src=https://example.com/images/site-logo.svg alt="Site Logo" height="64px" width="64px"></a>
    </div>
    <header>
        <nav>
    
    <div id="page-nav">
        <div class="page-nav-item">
            <a href="https://example.com/">Home</a>
        </div>
        
            <div class="page-nav-item">
                <a href="/about/">
                    
                    <span>About</span>
                </a>
            </div>
        
    </div>
</nav>
        
    </header>




<div id="content">
    <article class="h-entry">
        <header>
            <h1 class="post-title p-name">Linux å‘½ä»¤è¡Œå‚æ•°å¤„ç†</h1>
            
            <p class="post-date">Posted on
                <time class="dt-published" datetime="2018-08-05T13:32:51&#43;08:00">
                    5 August, 2018 at 13:32 CST
                </time>  by <a href="https://example.com/" class="p-author h-card"
                    rel="author">Author Name</a>
            </p>
            
            
            <p class="post-tag">Category:
                
                <a href="https://example.com/categories/programming" class="post-tag p-category">programming</a>
                
            </p>
            <hr class="post-underline">
            
        </header>
        <section class="content e-content">
            <p>å‰å‡ å¤©é‡åˆ°å¯¹ä¸åŒæƒ…å†µä¸‹ï¼Œæœ‰ä¸ªå‘½ä»¤çš„å¤„ç†æ¡ä»¶éœ€è¦åŒºåˆ«çš„ä»»åŠ¡ï¼Œçœ‹äº†ä¸‹åŸå§‹çš„ä»£ç ï¼Œå‘ç°éš¾ä»¥æ”¹åŠ¨ï¼Œå¤ªå¤šçš„HARD CODEäº†ï¼Œç›´æ¥ä½¿ç”¨argv[i]çš„æ–¹å¼è·å–å‚æ•°å€¼æ˜¾å¾—ç‰¹åˆ«
ä¸å¥½ä¿®æ”¹ï¼Œäºæ˜¯æƒ³åˆ°Linuxä¸‹æœ‰ä¸“é—¨çš„getoptæ–¹æ³•ï¼Œå¥½åœ¨ä¸ç®—æ”¹åŠ¨ç‰¹åˆ«å¤§ï¼Œå¯¹ä»¥å‰çš„åšæ³•ä½œäº†å…¼å®¹å¤„ç†ï¼Œå¥½å§ï¼Œè¿™é‡Œè¿˜æ˜¯å¯¹getoptä½œä¸ªç®€è¦çš„æ•´ç†å§ï¼Œæ–¹ä¾¿æ—¥åå›é¡¾ã€‚</p>
<h3 id="ç®€è¦è¯´æ˜">ç®€è¦è¯´æ˜</h3>
<p>getopt/getopt_longéƒ½æ˜¯linuxå¹³å°ä¸‹ä¸ºåº”ç”¨ç¨‹åºæä¾›å¤„ç†å‘½ä»¤è¡Œå‚æ•°çš„æ¥å£ï¼ŒåŒºåˆ«åœ¨äºåè€…æœ‰å‚æ•°åç§°é•¿åº¦è¾ƒé•¿çš„æƒ…å†µï¼Œä¸€èˆ¬åœ¨Linuxä¸‹çš„å‘½ä»¤è¡Œå‚æ•°ä»¥æ¨ªæ¡†â€œ-â€æˆ–è€…åŒæ¨ªæ 
â€œ&ndash;â€è¿›è¡Œä¼ é€’ï¼Œæ¯”å¦‚æˆ‘ä»¬ç»å¸¸ç”¨åˆ°çš„ls -l æˆ–è€… ls &ndash;help ï¼Œå…¶ä¸­çš„lå’Œhelpä¸ºé€‰é¡¹ã€‚</p>
<h3 id="å¦‚ä½•åœ¨ç¨‹åºä¸­ä½¿ç”¨">å¦‚ä½•åœ¨ç¨‹åºä¸­ä½¿ç”¨</h3>
<p>åœ¨manæ‰‹å†Œä¸Šçš„å®šä¹‰å¦‚ä¸‹ï¼š</p>
<pre><code>#include &lt;unistd.h&gt;

int getopt(int argc, char * const argv[], const char *optstring);

extern char *optarg;
extern int optind, opterr, optopt;

#include &lt;getopt.h&gt;

int getopt_long(int argc, char * const argv[], const char *optstring,
			const struct option *longopts, int *longindex);
</code></pre><p>è¿™ä¸¤ä¸ªAPIçš„å‚æ•°ä¸ç”¨å¤šè¯´äº†ï¼Œéœ€è¦æ³¨æ„çš„æ˜¯getopt/getopt_longéœ€è¦å¾ªç¯è°ƒç”¨å¤„ç†å‘½ä»¤è¡Œå‚æ•°ï¼Œä¹Ÿå°±æ˜¯ä¸€èˆ¬åœ¨whileå¾ªç¯ä¸­è°ƒç”¨ã€‚</p>
<p>ä¸€èˆ¬å‚æ•°é€‰é¡¹æœ‰éœ€è¦æ¥å€¼çš„ç±»å‹å’Œä¸éœ€æŒ‡å®šå‚æ•°å€¼ä»¥åŠå¯é€‰æŒ‡å®šå€¼ä¸‰ç§æƒ…å†µï¼Œä¸åŒçš„æƒ…å†µæœ‰ç‰¹å®šçš„å†™æ³•ï¼Œ</p>
<p>å¯¹äºgetoptæ¥è®²ï¼š</p>
<ul>
<li>éœ€è¦æŒ‡å®šå‚æ•°å€¼è¦åœ¨é€‰é¡¹åé¢æ¥ä¸€ä¸ªå†’å·</li>
<li>ä¸éœ€è¦æŒ‡å®šå‚æ•°å€¼åˆ™é€‰é¡¹åé¢ä¸æ¥ä»»ä½•ç¬¦å·</li>
<li>å¯é€‰å‚æ•°å€¼åˆ™åœ¨é€‰é¡¹åæ¥ä¸¤ä¸ªå†’å·</li>
</ul>
<p>å¯¹äºgetopt_longæ¥è¯´ï¼Œåœ¨optionç»“æ„ä½“ä¸­
struct option {
const char *name;
int         has_arg;
int        *flag;
int         val;
};
çš„has_argå˜é‡æœ‰ä¸‰ä¸ªå€¼å¯ä»¥æŒ‡å®šï¼š</p>
<ul>
<li>no_argument</li>
<li>required_argument</li>
<li>optional_argument</li>
</ul>
<h3 id="è¿”å›å€¼">è¿”å›å€¼</h3>
<p>å¯¹äºçŸ­çš„é€‰é¡¹ï¼š
å¦‚æœgetopt/getopt_logåœ¨å‘½ä»¤è¡Œå‚æ•°ä¸­æ‰¾åˆ°ç›¸åº”å­—ç¬¦ï¼Œåˆ™ä¼šè¿”å›è¯¥é€‰é¡¹çš„å­—ç¬¦ï¼Œå¦‚æœæ‰€æœ‰çš„å‘½ä»¤å‚æ•°é€‰é¡¹éƒ½è§£æå®Œæˆï¼Œåˆ™è¿”å›-1ï¼Œ
å¦‚æœå‘ç°å‘½ä»¤è¡Œå‚æ•°é€‰é¡¹ä¸­çš„å­—ç¬¦ä¸åœ¨æŒ‡å®šçš„optstringä¸­å‡ºç°ï¼Œåˆ™è¿”å›ç‰¹æ®Šçš„é—®å·å­—ç¬¦ï¼Ÿã€‚å¦‚æœé‡åˆ°è¯¥å‚æ•°é€‰é¡¹éœ€è¦æŒ‡å®šå€¼è€Œå‘½ä»¤è¡Œä¸­æœªæŒ‡å®šæ—¶ï¼Œ
è¿”å›å€¼å–å†³äºoptstringä¸­çš„ç¬¬ä¸€ä¸ªå†’å·å­—ç¬¦ï¼šï¼Œå¦‚æœå®ƒæ˜¯å†’å·ï¼Œåˆ™è¿”å›ï¼šï¼Œå¦åˆ™è¿”å›ï¼Ÿã€‚</p>
<p>å¯¹äºé•¿é€‰é¡¹ï¼š
æ­£å¸¸æƒ…å†µä¸‹ï¼Œå¦‚æœflagä¸ºNULLï¼Œåˆ™è¿”å›optionç»“æ„ä½“ä¸­çš„valå€¼ï¼Œå¦åˆ™è¿”å›0ã€‚å…¶ä»–å‡ºé”™ï¼ŒæœªåŒ¹é…ä»¥åŠ-1çš„æƒ…å†µåŒçŸ­é€‰é¡¹æ˜¯ä¸€æ ·çš„ã€‚</p>
<h3 id="ä¸¤ä¸ªç¤ºä¾‹">ä¸¤ä¸ªç¤ºä¾‹</h3>
<p>å®˜ç½‘ç»™å‡ºçš„ä¸¤ä¸ªç¤ºä¾‹éå¸¸å®ç”¨ï¼š</p>
<ol>
<li>getopt</li>
</ol>
<pre><code>       #include &lt;unistd.h&gt;
       #include &lt;stdlib.h&gt;
       #include &lt;stdio.h&gt;

       int
       main(int argc, char *argv[])
       {
           int flags, opt;
           int nsecs, tfnd;

           nsecs = 0;
           tfnd = 0;
           flags = 0;
           while ((opt = getopt(argc, argv, &quot;nt:&quot;)) != -1) {
               switch (opt) {
               case 'n':
                   flags = 1;
                   break;
               case 't':
                   nsecs = atoi(optarg);
                   tfnd = 1;
                   break;
               default: /* '?' */
                   fprintf(stderr, &quot;Usage: %s [-t nsecs] [-n] name\n&quot;,
                           argv[0]);
                   exit(EXIT_FAILURE);
               }
           }

           printf(&quot;flags=%d; tfnd=%d; nsecs=%d; optind=%d\n&quot;,
                   flags, tfnd, nsecs, optind);

           if (optind &gt;= argc) {
               fprintf(stderr, &quot;Expected argument after options\n&quot;);
               exit(EXIT_FAILURE);
           }

           printf(&quot;name argument = %s\n&quot;, argv[optind]);

           /* Other code omitted */

           exit(EXIT_SUCCESS);
       }
</code></pre><ol start="2">
<li>getopt_long</li>
</ol>
<pre><code>		#include &lt;stdio.h&gt;     /* for printf */ 
		#include &lt;stdlib.h&gt;    /* for exit */ 
		#include &lt;getopt.h&gt;

        int main(int argc, char **argv) {
           int c;
           int digit_optind = 0;

           while (1) {
               int this_option_optind = optind ? optind : 1;
               int option_index = 0;
               static struct option long_options[] = {
                   {&quot;add&quot;,     required_argument, 0,  0 },
                   {&quot;append&quot;,  no_argument,       0,  0 },
                   {&quot;delete&quot;,  required_argument, 0,  0 },
                   {&quot;verbose&quot;, no_argument,       0,  0 },
                   {&quot;create&quot;,  required_argument, 0, 'c'},
                   {&quot;file&quot;,    required_argument, 0,  0 },
                   {0,         0,                 0,  0 }
               };

               c = getopt_long(argc, argv, &quot;abc:d:012&quot;,
                        long_options, &amp;option_index);
               if (c == -1)
                   break;

               switch (c) {
               case 0:
                   printf(&quot;option %s&quot;, long_options[option_index].name);
                   if (optarg)
                       printf(&quot; with arg %s&quot;, optarg);
                   printf(&quot;\n&quot;);
                   break;

               case '0':
               case '1':
               case '2':
                   if (digit_optind != 0 &amp;&amp; digit_optind != this_option_optind)
                   printf(&quot;digits occur in two different argv elements.\n&quot;);
                   digit_optind = this_option_optind;
                   printf(&quot;option %c\n&quot;, c);
                   break;

               case 'a':
                   printf(&quot;option a\n&quot;);
                   break;

               case 'b':
                   printf(&quot;option b\n&quot;);
                   break;

               case 'c':
                   printf(&quot;option c with value '%s'\n&quot;, optarg);
                   break;

               case 'd':
                   printf(&quot;option d with value '%s'\n&quot;, optarg);
                   break;

               case '?':
                   break;

               default:
                   printf(&quot;?? getopt returned character code 0%o ??\n&quot;, c);
               }
           }

           if (optind &lt; argc) {
               printf(&quot;non-option ARGV-elements: &quot;);
               while (optind &lt; argc)
                   printf(&quot;%s &quot;, argv[optind++]);
               printf(&quot;\n&quot;);
           }

           exit(EXIT_SUCCESS); }
</code></pre><p>è¶…è¯¦ç»†å‚è€ƒèµ„æ–™åœ¨<a href="http://man7.org/linux/man-pages/man3/getopt.3.html">è¿™é‡Œ</a>.</p>
        </section>
        <footer>
            <a class="permalink u-url" href="https://example.com/post/getopt_usage/">ğŸ”—</a>
            
            <hr class="post-underline">
            <p class="post-tag">Tags for this post:
                
                <a href="https://example.com/tags/linux-c" class="post-tag p-category">linux-c</a>
                
            </p>
            
        </footer>
    </article>
</div>

    
    <div class="h-card">
      <img class="u-photo" src="https://example.com/images/site-logo.svg" />
      <div class="card-content">
        <h2 class="card-name"><a class="p-name u-url" href="https://example.com/" rel="me">Author Name</a></h2>
        <p class="card-subhead">
          <span class="p-locality">CityName</span>,
          <span class="p-country-name">CountryName</span><br />
          <a class="u-email" href="mailto:email.address@example.com">Email me</a>
        </p>
      </div>
      <p class="p-note">A short description, a few sentences describing the author. Set the &#39;ShowBio&#39; parameter to false to hide this.</p>
    </div>
    
    <div id="footer">
      
      <nav id="article-skip">
        <div class="next">
          
          <a alt="Newer article" href="https://example.com/post/start_server_with_ip/">&larr; Newer</a>
          
        </div>
        <div class="top">
          <a alt="Top of page" href="#">Top</a>
        </div>
        <div class="prev">
          
          <a alt="Older article" href="https://example.com/post/open_fd_question/">Older &rarr;</a>
          
        </div>
      </nav>
      
      <aside id="social">
  <div id="social-icons">
    
    <div class="icon-24x24">
      <a class="glyph" alt="Email me" href="mailto:email.address@example.com"><img src=https://example.com/icons/envelope.svg height="24px" width="24px"></a>
    </div>
    
    
    <div class="icon-24x24">
      <a class="glyph" alt="Facebook profile" href="https://facebook.com/FacebookUserName"><img src=https://example.com/icons/facebook.svg height="24px" width="24px"></a>
    </div>
    
    
    <div class="icon-24x24">
      <a class="glyph" alt="Flickr profile" href="https://flickr.com/people/FlickrUserName"><img src=https://example.com/icons/flickr.svg height="24px" width="24px"></a>
    </div>
    
    
    <div class="icon-24x24">
      <a class="glyph" alt="GitHub profile" href="https://github.com/GitHubUserName"><img src=https://example.com/icons/github.svg height="24px" width="24px"></a>
    </div>
    
    
    <div class="icon-24x24">
      <a class="glyph" alt="GitLab profile" href="https://gitlab.com/GitLabUserName"><img src=https://example.com/icons/gitlab.svg height="24px" width="24px"></a>
    </div>
    
    
    <div class="icon-24x24">
      <a class="glyph" alt="Glitch profile" href="https://glitch.com/@GlitchUserName"><img src=https://example.com/icons/glitch.svg height="24px" width="24px"></a>
    </div>
    
    
    <div class="icon-24x24">
      <a class="glyph" alt="Keybase profile" href="https://keybase.io/KeybaseUserName"><img src=https://example.com/icons/keybase.svg height="24px" width="24px"></a>
    </div>
    
    
    <div class="icon-24x24">
      <a class="glyph" alt="LinkedIn profile" href="https://www.linkedin.com/in/LinkedInUserName"><img src=https://example.com/icons/linkedin.svg height="24px" width="24px"></a>
    </div>
    
    
    <div class="icon-24x24">
      <a class="glyph" alt="Medium profile" href="https://medium.com/MediumUserName"><img src=https://example.com/icons/medium.svg height="24px" width="24px"></a>
    </div>
    
    
    <div class="icon-24x24">
      <a class="glyph" alt="Micro.Blog profile" href="https://micro.blog/MicroBlogUserName"><img src=https://example.com/icons/microblog.svg height="24px" width="24px"></a>
    </div>
    
    
    <div class="icon-24x24">
      <a class="glyph" alt="Reddit profile" href="https://www.reddit.com/user/RedditUserName"><img src=https://example.com/icons/reddit-alien.svg height="24px" width="24px" /></a>
    </div>
    
    
    <div class="icon-24x24">
      <a class="glyph" alt="Stack Overflow profile" href="https://stackoverflow.com/users/StackOverflowUserName"><img src=https://example.com/icons/stack-overflow.svg height="24px" width="24px"></a>
    </div>
    
    
    <div class="icon-24x24">
      <a class="glyph" alt="Tumblr profile" href="https://TumblrUserName.tumblr.com/"><img src=https://example.com/icons/tumblr.svg height="24px" width="24px"></a>
    </div>
    
    
    <div class="icon-24x24">
      <a class="glyph" alt="Twitter profile" href="https://twitter.com/TwitterUserName"><img src=https://example.com/icons/twitter.svg height="24px" width="24px"></a>
     </div>
     
    
    <div class="icon-24x24">
      <a class="glyph" alt="Instagram profile" href="https://instagram.com/TwitterUserName"><img
          src=https://example.com/icons/instagram.svg height="24px" width="24px"></a>
    </div>
    
  </div>
</aside>

      
      <p class="copyright">
          Copyright Â© 2018, Author Name
      </p>
      
    </div>


</body>
</html>